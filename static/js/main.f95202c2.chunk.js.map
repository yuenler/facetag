{"version":3,"sources":["firebase.js","contexts/AuthContext.js","components/Login.js","components/screens/Profile.Screen.js","components/screens/Home.Screen.js","components/App.js","index.js"],"names":["app","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","auth","AuthContext","React","createContext","useAuth","useContext","AuthProvider","children","useState","currentUser","setCurrentUser","loading","setLoading","useEffect","onAuthStateChanged","user","value","changeUser","Provider","responseGoogle","response","console","log","LoginScreen","history","useHistory","res","a","profileObj","email","indexOf","alert","push","Card","style","backgroundColor","Body","className","color","display","justifyContent","clientId","buttonText","onSuccess","onFailure","cookiePolicy","isSignedIn","uxMode","redirectUri","window","location","href","useStyles","makeStyles","theme","button","margin","spacing","ProfileScreen","FACING_MODE_USER","videoConstraints","facingMode","setFacingMode","handleClick","useCallback","prevState","classes","webcamRef","useRef","nameRef","phoneRef","instaRef","snapRef","descriptors","openCamera","setOpenCamera","setButtonText","averageDescriptor","setAverageDescriptor","doneRunning","setDoneRunning","startedRunning","setStartedRunning","name","phone","insta","snap","handleHome","saveData","current","database","ref","googleId","set","descriptor","error","handleLeaveCamera","runFaceapi","faceapi","length","detect","takeAverage","averages","i","average","sum","j","video","readyState","withFaceLandmarks","withFaceDescriptor","detectionWithDescriptors","clearInterval","interval","IconButton","aria-label","onClick","marginLeft","marginRight","left","right","textAlign","zindex","width","height","Button","variant","size","Form","startIcon","Group","id","Label","Control","defaultValue","placeholder","required","document","addEventListener","data","HomeScreen","FACING_MODE_ENVIRONMENT","prediction","setPrediction","predictionOut","setPredictionOut","setName","setPhone","setSnap","setInsta","phoneSMS","compareFaces","closest","on","snapshot","val","distance","onLogoutSuccess","border","paddingTop","App","Container","minHeight","maxWidth","basename","exact","path","component","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.f95202c2.chunk.js","sourcesContent":["import firebase from \"firebase/app\"\r\nimport \"firebase/auth\"\r\n\r\nconst app = firebase.initializeApp({\r\n  apiKey: \"AIzaSyCUqHmiQD8PkE0UDMsuHjAhrZ9QQNrydeg\",\r\n  authDomain: \"nametag-de54e.firebaseapp.com\",\r\n  projectId: \"nametag-de54e\",\r\n  storageBucket: \"nametag-de54e.appspot.com\",\r\n  messagingSenderId: \"686023333837\",\r\n  appId: \"1:686023333837:web:80907e123a1eb4f45e5684\",\r\n  measurementId: \"G-YYT9G3V3TS\"\r\n})\r\n\r\nexport const auth = app.auth()\r\nexport default app\r\n","import React, { useContext, useState, useEffect } from \"react\"\r\nimport { auth } from \"../firebase\"\r\n\r\nconst AuthContext = React.createContext()\r\n\r\nexport function useAuth() {\r\n  return useContext(AuthContext)\r\n}\r\n\r\n\r\nexport function AuthProvider({ children }) {\r\n  const [currentUser, setCurrentUser] = useState()\r\n  const [loading, setLoading] = useState(true)\r\n\r\n\r\n  function changeUser(user) {\r\n    setCurrentUser(user)\r\n  }\r\n  \r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged(user => {\r\n      setCurrentUser(user)\r\n      setLoading(false)\r\n    })\r\n\r\n    return unsubscribe\r\n  }, [])\r\n\r\n  \r\n\r\n  const value = {\r\n    currentUser,\r\n    changeUser,\r\n  }\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {!loading && children}\r\n    </AuthContext.Provider>\r\n  )\r\n}\r\n","import React from \"react\"\r\nimport {  Card } from \"react-bootstrap\"\r\nimport { useAuth } from \"../contexts/AuthContext\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { GoogleLogin } from 'react-google-login';\r\n\r\nconst responseGoogle = response => {\r\n  console.log(response);\r\n};\r\n\r\nexport default function LoginScreen() {\r\n  const { changeUser } = useAuth()\r\n  const history = useHistory()\r\n\r\n  async function handleLogin(res) {\r\n      await changeUser(res.profileObj)\r\n      let email = res.profileObj.email\r\n      var idxHarvard = email.indexOf('@college.harvard.edu');\r\n      if (idxHarvard === -1) {\r\n        alert(\"Please sign in using your Harvard College email address!\");\r\n        await changeUser(null)\r\n        email = null\r\n      }\r\n      else{\r\n        history.push(\"/\")\r\n      }\r\n      \r\n  }\r\n\r\n  return (\r\n\r\n      <Card style={{backgroundColor: '#A51C30'}}>\r\n        <Card.Body>\r\n          <h2 className=\"text-center mb-4\" style={{color: 'white'}}>Nametag</h2>\r\n          <div style={{display: 'flex', justifyContent: 'center'}}>\r\n              <GoogleLogin\r\n                clientId='686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com'\r\n                buttonText=\"Log in with Google\"\r\n                onSuccess={handleLogin}\r\n                onFailure={responseGoogle}\r\n                cookiePolicy={'single_host_origin'}\r\n                isSignedIn={true}\r\n                uxMode=\"redirect\"\r\n                redirectUri={window.location.href}\r\n            />\r\n            </div>\r\n\r\n        </Card.Body>\r\n      </Card>\r\n\r\n  )\r\n}\r\n","import React, { useRef, useEffect, useState } from \"react\";\r\nimport firebase from \"firebase\";\r\nimport { Form } from \"react-bootstrap\"\r\nimport Webcam from \"react-webcam\";\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Button from '@material-ui/core/Button';\r\nimport Check from '@material-ui/icons/Check';\r\nimport Clear from '@material-ui/icons/Clear';\r\nimport FlipCameraIos from '@material-ui/icons/FlipCameraIos';\r\n\r\nimport Error from '@material-ui/icons/Error';\r\n\r\nimport Home from '@material-ui/icons/Home';\r\nimport CameraAlt from '@material-ui/icons/CameraAlt';\r\nimport * as faceapi from 'face-api.js';\r\nimport {useHistory } from \"react-router-dom\"\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport { useAuth } from \"../../contexts/AuthContext\"\r\n\r\n\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: \"#A51C30\",\r\n\r\n  },\r\n}));\r\n\r\n\r\nfunction ProfileScreen() {\r\n  const FACING_MODE_USER = \"user\";\r\n  const FACING_MODE_ENVIRONMENT = \"environment\";\r\n\r\n  const videoConstraints = {\r\n    facingMode: FACING_MODE_USER\r\n  };\r\n\r\n  const [facingMode, setFacingMode] = React.useState(FACING_MODE_USER);\r\n\r\n  const handleClick = React.useCallback(() => {\r\n      setFacingMode(\r\n        prevState =>\r\n          prevState === FACING_MODE_USER\r\n            ? FACING_MODE_ENVIRONMENT\r\n            : FACING_MODE_USER\r\n      );\r\n    }, []);\r\n\r\n  const classes = useStyles();\r\n  const history = useHistory()\r\n  const { currentUser } = useAuth()\r\n  const webcamRef = useRef(null);\r\n  const nameRef = useRef()\r\n  const phoneRef = useRef()\r\n  const instaRef = useRef()\r\n  const snapRef = useRef()\r\n\r\n  let descriptors = [];\r\n  let interval;\r\n  \r\n  const [openCamera, setOpenCamera] = useState(false);\r\n  const [buttonText, setButtonText] = useState(\"Run facial recognition\")\r\n  const [averageDescriptor, setAverageDescriptor] = useState(null)\r\n  const [doneRunning, setDoneRunning] = useState(false)\r\n  const [startedRunning, setStartedRunning] = useState(true)\r\n  const [name, setName] = useState(null)\r\n  const [phone, setPhone] = useState(null)\r\n  const [insta, setInsta] = useState(null)\r\n  const [snap, setSnap] = useState(null)\r\n  const NUM_READINGS = 5;\r\n\r\n  function retrieveData() {\r\n  //   firebase.database().ref('Users/' + currentUser.googleId).once(\"value\", snapshot => {\r\n  //     if (snapshot.exists()){\r\n  //        setAverageDescriptor(snapshot.val().descriptor)\r\n  //        setName(snapshot.val().name)\r\n  //        setPhone(snapshot.val().phone)\r\n  //        setInsta(snapshot.val().insta)\r\n  //        setSnap(snapshot.val().snap)\r\n  //     }\r\n  //  });\r\n\r\n  }\r\n\r\n\r\n  function handleHome() {\r\n    history.push(\"/\")\r\n  }\r\n\r\n  function handleSubmit() {\r\n    saveData()\r\n  }\r\n\r\n  const saveData = () => {\r\n    if (nameRef.current.value === '' || averageDescriptor == null){\r\n      alert(\"Please scan your face and fill in your name.\")\r\n    }\r\n    else{\r\n    firebase.database().ref('Users/' + currentUser.googleId).set({\r\n\t\t\tdescriptor: averageDescriptor,\r\n      name: nameRef.current.value,\r\n      phone: phoneRef.current.value,\r\n      insta: instaRef.current.value,\r\n      snap: snapRef.current.value,\r\n\t\t  },\r\n\t\t  (error) => {\r\n\t\t\t\tconsole.log(error);\r\n\t\t  } \r\n\t\t  );\r\n      handleHome();\r\n      alert('Successfully saved data!')\r\n    }\r\n  }\r\n\r\n\r\n  const handleCamera = () => {\r\n    setDoneRunning(false)\r\n    setStartedRunning(false)\r\n    setOpenCamera(true)\r\n  }\r\n\r\n  const handleLeaveCamera = () => {\r\n    setOpenCamera(false)\r\n    setStartedRunning(true)\r\n  }\r\n\r\n  const handleRunFaceapi = () => {\r\n    setStartedRunning(true)\r\n    setButtonText(\"Running facial recognition...\")\r\n    runFaceapi()\r\n    \r\n  }\r\n\r\n\r\n  const runFaceapi = async () => {\r\n    await faceapi.loadSsdMobilenetv1Model('/nametag/models');\r\n    await faceapi.loadFaceLandmarkModel('/nametag/models');\r\n    await faceapi.loadFaceRecognitionModel('/nametag/models');\r\n    while (descriptors.length <= NUM_READINGS){\r\n      await detect()\r\n    }\r\n  };\r\n\r\n  const takeAverage = (descriptors) => {\r\n    let averages = []\r\n   \r\n    for(let i = 0; i < 128; i++) {\r\n      let sum = 0;\r\n      let average;\r\n      for(let j = 0; j < descriptors.length; j++) {\r\n        sum += descriptors[j][i];\r\n      }\r\n      average = sum/descriptors.length;\r\n      \r\n      averages.push(average);\r\n    }\r\n\r\n    return averages;\r\n  }\r\n\r\n\r\n  const detect = async () => {\r\n    if (\r\n      typeof webcamRef.current !== \"undefined\" &&\r\n      webcamRef.current !== null &&\r\n      webcamRef.current.video.readyState === 4\r\n    ) {\r\n      // Get Video Properties\r\n      const video = webcamRef.current.video;\r\n\r\n      const detectionWithDescriptors = await faceapi.detectSingleFace(video).withFaceLandmarks().withFaceDescriptor()\r\n      if(detectionWithDescriptors != null){\r\n        descriptors.push(detectionWithDescriptors.descriptor);\r\n        if (descriptors.length >= NUM_READINGS){\r\n          clearInterval(interval);\r\n          setButtonText(\"Run facial recognition\")\r\n          if (descriptors.length === NUM_READINGS){\r\n            let descriptor = takeAverage(descriptors);\r\n            setAverageDescriptor(descriptor)\r\n            setDoneRunning(true)\r\n            setStartedRunning(false)\r\n\r\n          }\r\n\r\n        }\r\n      \r\n      }\r\n     \r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    retrieveData()\r\n  });\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n      <IconButton aria-label=\"home\" onClick={() => { handleHome() }}>\r\n        <Home />\r\n      </IconButton>\r\n\r\n      { !startedRunning?\r\n        <IconButton aria-label=\"clear\" onClick={() => { handleLeaveCamera() }}>\r\n        <Clear />\r\n      </IconButton>: null\r\n      }\r\n\r\n      {openCamera?\r\n        <div>\r\n        \r\n        <Webcam\r\n          ref={webcamRef}\r\n          style={{\r\n            marginLeft: \"auto\",\r\n            marginRight: \"auto\",\r\n            left: 0,\r\n            right: 0,\r\n            textAlign: \"center\",\r\n            zindex: 9,\r\n            width: 300,\r\n            height: 300,\r\n          }}\r\n          videoConstraints={{\r\n            ...videoConstraints,\r\n            facingMode\r\n          }}\r\n        />\r\n    {!doneRunning?\r\n      <div>\r\n      <Button\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"small\"\r\n        className={classes.button}\r\n        onClick={() => handleRunFaceapi() }\r\n      >\r\n        {buttonText}\r\n      </Button>\r\n\r\n      {!startedRunning?\r\n      <IconButton onClick={handleClick}>\r\n        <FlipCameraIos/>\r\n        </IconButton>: null\r\n      }\r\n\r\n      </div>\r\n      \r\n      :\r\n      <div>\r\n            <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            size=\"small\"\r\n            className={classes.button}\r\n            onClick={() => handleLeaveCamera() }\r\n          >\r\n            Finish\r\n            </Button>\r\n      </div>\r\n      }\r\n        <p>Hold the phone so that your face takes up the majority of the screen, but no parts of your head is cut off. Make sure you have good lighting and that you are not holding the phone at an angle. When you are ready, click the button above. </p>\r\n        \r\n      </div>\r\n        :\r\n        <div>\r\n          <p>The following inputs will be public to all Harvard College students when they scan your face. Please leave any field for which you do not want to be publicly available blank.</p>\r\n          <Form>\r\n     \r\n                <Button\r\n              variant=\"contained\"\r\n              color=\"primary\"\r\n              size=\"small\"\r\n              className={classes.button}\r\n              startIcon={<CameraAlt />}\r\n              onClick={() => handleCamera() }\r\n            >\r\n              Open Camera to scan face\r\n            </Button>\r\n\r\n            {\r\n              averageDescriptor ?\r\n              <Check/>:\r\n              <Error/>\r\n            }\r\n\r\n            <div>\r\n            <Form.Group id=\"name\">\r\n              <Form.Label>Name</Form.Label>\r\n              <Form.Control ref={nameRef} defaultValue = {name} placeholder=\"John Harvard\" required />\r\n            </Form.Group>\r\n\r\n            <Form.Group id=\"phone\">\r\n              <Form.Label>Phone number</Form.Label>\r\n              <Form.Control placeholder=\"555-555-5555\" defaultValue = {phone} ref={phoneRef}  />\r\n            </Form.Group>\r\n\r\n            <Form.Group id=\"insta\">\r\n              <Form.Label>Instagram</Form.Label>\r\n              <Form.Control placeholder=\"username\" defaultValue = {insta} ref={instaRef}  />\r\n            </Form.Group>\r\n\r\n            <Form.Group id=\"snap\">\r\n              <Form.Label>Snapchat</Form.Label>\r\n              <Form.Control placeholder=\"username\" defaultValue = {snap} ref={snapRef}  />\r\n            </Form.Group>\r\n            </div>\r\n            \r\n            <Button\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"small\"\r\n        className={classes.button}\r\n        onClick={() => handleSubmit() }\r\n      >\r\n        Save Profile\r\n      </Button>\r\n          </Form>\r\n          \r\n        </div>\r\n      }\r\n      </header>\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default ProfileScreen;","import React, { useRef, useEffect, useState } from \"react\";\r\nimport firebase from \"firebase\";\r\nimport Webcam from \"react-webcam\";\r\nimport * as faceapi from 'face-api.js';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport AccountCircle from '@material-ui/icons/AccountCircle';\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { GoogleLogout } from 'react-google-login';\r\nimport { useAuth } from \"../../contexts/AuthContext\"\r\nimport { makeStyles } from '@material-ui/core/styles';\r\nimport Button from '@material-ui/core/Button';\r\nimport FlipCameraIos from '@material-ui/icons/FlipCameraIos';\r\n\r\n\r\n\r\n// document.getElementsByTagName(\"body\")[0].style.backgroundColor = \"black\";\r\ndocument.addEventListener(\"message\", function(data) {\r\n  alert(data.data);\r\n});\r\n\r\nconst useStyles = makeStyles((theme) => ({\r\n  button: {\r\n    margin: theme.spacing(1),\r\n    backgroundColor: \"#A51C30\",\r\n  },\r\n}));\r\n\r\nfunction HomeScreen() {\r\n\r\n  const FACING_MODE_USER = \"user\";\r\n  const FACING_MODE_ENVIRONMENT = \"environment\";\r\n\r\n  const videoConstraints = {\r\n    facingMode: FACING_MODE_USER\r\n  };\r\n\r\n    const [facingMode, setFacingMode] = React.useState(FACING_MODE_ENVIRONMENT);\r\n\r\n    const handleClick = React.useCallback(() => {\r\n      setFacingMode(\r\n        prevState =>\r\n          prevState === FACING_MODE_USER\r\n            ? FACING_MODE_ENVIRONMENT\r\n            : FACING_MODE_USER\r\n      );\r\n    }, []);\r\n\r\n\r\n  const history = useHistory()\r\n  const { changeUser, currentUser } = useAuth()\r\n  const classes = useStyles();\r\n  const [prediction, setPrediction] = useState(\"Hold the phone so that the person's face takes up the majority of the screen, but no part of their head is off screen. Make sure you have good lighting and that you are not holding the camera at an angle. When you are ready, click the button above.\");\r\n  const [predictionOut, setPredictionOut] = useState(false);\r\n\r\n  const [buttonText, setButtonText] = useState(\"Run facial recognition\")\r\n  const [name, setName] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [snap, setSnap] = useState(\"\");\r\n  const [insta, setInsta] = useState(\"\");\r\n  const [startedRunning, setStartedRunning] = useState(false)\r\n  const phoneSMS = \"sms:\" + phone;\r\n  const webcamRef = useRef(null);\r\n  const NUM_READINGS = 1;\r\n\r\n  function handleProfile() {\r\n    history.push(\"/profile\")\r\n  }\r\n\r\n  const checkProfileExistence = () => {\r\n  //   firebase.database().ref('Users/' + currentUser.googleId).once(\"value\", snapshot => {\r\n  //     if (!snapshot.exists()){\r\n  //        history.push(\"/profile\")\r\n  //        alert('Please fill out your profile first!')\r\n  //     }\r\n  //  });\r\n  }\r\n\r\n\r\n  let descriptors = [];\r\n  let averageDescriptor;\r\n  let interval;\r\n\r\n  const handleRunFaceapi = () => {\r\n    setButtonText(\"Running facial recognition...\");\r\n    setStartedRunning(true)\r\n    setName(\"\");\r\n    setPhone(\"\");\r\n    setSnap(\"\");\r\n    setInsta(\"\");\r\n    setPredictionOut(false);\r\n    runFaceapi()\r\n  }\r\n\r\n  async function logout() {\r\n    await changeUser(null)\r\n    history.push(\"/login\")\r\n  }\r\n\r\n  const runFaceapi = async () => {\r\n    await faceapi.loadSsdMobilenetv1Model('/nametag/models');\r\n    await faceapi.loadFaceLandmarkModel('/nametag/models');\r\n    await faceapi.loadFaceRecognitionModel('/nametag/models');\r\n    while (descriptors.length <= NUM_READINGS){\r\n      await detect()\r\n    }\r\n  };\r\n\r\n  const takeAverage = (descriptors) => {\r\n    let averages = []\r\n   \r\n    for(let i = 0; i < 128; i++) {\r\n      let sum = 0;\r\n      let average;\r\n      for(let j = 0; j < descriptors.length; j++) {\r\n        sum += descriptors[j][i];\r\n      }\r\n      average = sum/descriptors.length;\r\n      \r\n      averages.push(average);\r\n    }\r\n\r\n    return averages;\r\n  }\r\n\r\n  const detect = async () => {\r\n    if (\r\n      typeof webcamRef.current !== \"undefined\" &&\r\n      webcamRef.current !== null &&\r\n      webcamRef.current.video.readyState === 4\r\n    ) {\r\n      // Get Video Properties\r\n      const video = webcamRef.current.video;\r\n\r\n      const detectionWithDescriptors = await faceapi.detectSingleFace(video).withFaceLandmarks().withFaceDescriptor()\r\n      if(detectionWithDescriptors != null){\r\n        descriptors.push(detectionWithDescriptors.descriptor);\r\n        if (descriptors.length >= NUM_READINGS){\r\n          clearInterval(interval);\r\n          // setOpenCamera(false)\r\n          setButtonText(\"Run facial recognition\")\r\n          if (descriptors.length === NUM_READINGS){\r\n            setPrediction(\"Processing results...\\nIf no results appear within 10 seconds, this means that the scanned face does not match any face in our database.\")\r\n            averageDescriptor = takeAverage(descriptors);\r\n            compareFaces();\r\n            setStartedRunning(false)\r\n          }\r\n\r\n        }\r\n      \r\n      }\r\n     \r\n    }\r\n  };\r\n\r\n  const compareFaces = () => {\r\n    let closest = 1\r\n    firebase.database().ref('Users').on('child_added', (snapshot) => {\r\n      let user = snapshot.val()\r\n      let distance = 1;\r\n      if (user.descriptor != null){\r\n       distance = faceapi.euclideanDistance(user.descriptor, averageDescriptor)\r\n      }\r\n      if (distance < closest && distance < 0.5){\r\n        closest = distance\r\n        setPredictionOut(true)\r\n        setName(user.name)\r\n        setPhone(user.phone)\r\n        setSnap(user.snap)\r\n        setInsta(user.insta)\r\n        setPrediction('')\r\n      }\r\n    })\t\r\n  }\r\n\r\n  useEffect(() => {\r\n    checkProfileExistence()\r\n  });\r\n\r\n  return (\r\n    <div className=\"App\" style={{textAlign: 'center', /*backgroundColor: \"black\", color: \"white\" */}}>\r\n      <header className=\"App-header\">\r\n\r\n      <GoogleLogout\r\n        clientId=\"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com\"\r\n        buttonText=\"Logout\"\r\n        onLogoutSuccess={logout}\r\n      >\r\n      </GoogleLogout>\r\n\r\n      <Button\r\n        variant=\"contained\"\r\n        color=\"primary\"\r\n        size=\"small\"\r\n        className={classes.button}\r\n        startIcon={<AccountCircle />}\r\n        onClick={() => handleProfile() }\r\n      >\r\n        Edit Profile\r\n      </Button>\r\n\r\n      <div>\r\n          <Webcam\r\n            ref={webcamRef}\r\n            style={{\r\n              // position: \"absolute\",\r\n              marginLeft: \"auto\",\r\n              marginRight: \"auto\",\r\n              left: 0,\r\n              right: 0,\r\n              textAlign: \"center\",\r\n              zindex: 9,\r\n              width: 300,\r\n              height: 300,\r\n            }}\r\n            videoConstraints={{\r\n              ...videoConstraints,\r\n              facingMode\r\n            }}\r\n          />\r\n          <Button\r\n            variant=\"contained\"\r\n            color=\"primary\"\r\n            size=\"small\"\r\n            className={classes.button}\r\n            onClick={() => handleRunFaceapi() }\r\n            >\r\n            {buttonText}\r\n          </Button>\r\n          {!startedRunning?\r\n      <IconButton onClick={handleClick}>\r\n        <FlipCameraIos/>\r\n        </IconButton>: null\r\n      }\r\n\r\n      </div>\r\n      <hr/>\r\n      <p>{prediction}</p>\r\n      {predictionOut?\r\n        <div style={{border: \"2px solid black\", backgroundColor: \"lightgray\", paddingTop: \"10px\"}}>\r\n          <p>{\"Name: \" + name}</p>\r\n          <p>Phone number: <a href={phoneSMS}>{phone}</a></p>\r\n          <p>{\"Snapchat: \" + snap}</p>\r\n          <p>{\"Instagram: \" + insta}</p>\r\n        </div>\r\n        : null\r\n      }\r\n      <br/>\r\n      </header>\r\n    </div>\r\n\r\n  );\r\n}\r\n\r\nexport default HomeScreen;","import React from \"react\"\r\nimport { Container } from \"react-bootstrap\"\r\nimport { AuthProvider } from \"../contexts/AuthContext\"\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\"\r\nimport LoginScreen from \"./Login\"\r\nimport ProfileScreen from \"./screens/Profile.Screen\"\r\nimport PrivateRoute from \"./PrivateRoute\"\r\nimport HomeScreen from \"./screens/Home.Screen\"\r\n\r\n\r\nfunction App() {\r\n  return (\r\n    <Container\r\n      className=\"d-flex align-items-center justify-content-center\"\r\n      style={{ minHeight: \"100vh\" }}\r\n    >\r\n      <div className=\"w-100\" style={{ maxWidth: \"400px\" }}>\r\n        <Router basename=\"/nametag\">\r\n          <AuthProvider>\r\n            <Switch>\r\n              <Route exact path=\"/\" component={HomeScreen} />\r\n              <Route path=\"/profile\" component={ProfileScreen} />\r\n              <Route path=\"/login\" component={LoginScreen} />\r\n\r\n            </Switch>\r\n          </AuthProvider>\r\n        </Router>\r\n      </div>\r\n    </Container>\r\n  )\r\n}\r\n\r\nexport default App\r\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport App from \"./components/App\"\nimport \"bootstrap/dist/css/bootstrap.min.css\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)"],"sourceRoot":""}