(this.webpackJsonpnametag=this.webpackJsonpnametag||[]).push([[0],{107:function(e,t){},108:function(e,t){},109:function(e,t){},115:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),r=n(40),o=n.n(r),i=n(19),s=n.n(i),l=n(27),u=n(132),d=n(14),j=n(66),b=(n(89),j.a.initializeApp({apiKey:"AIzaSyCUqHmiQD8PkE0UDMsuHjAhrZ9QQNrydeg",authDomain:"nametag-de54e.firebaseapp.com",projectId:"nametag-de54e",storageBucket:"nametag-de54e.appspot.com",messagingSenderId:"686023333837",appId:"1:686023333837:web:80907e123a1eb4f45e5684",measurementId:"G-YYT9G3V3TS"})),h=b.auth(),f=n(6),p=c.a.createContext();function O(){return Object(a.useContext)(p)}function g(e){var t=e.children,n=Object(a.useState)(),c=Object(d.a)(n,2),r=c[0],o=c[1],i=Object(a.useState)(!0),s=Object(d.a)(i,2),l=s[0],u=s[1];Object(a.useEffect)((function(){return h.onAuthStateChanged((function(e){o(e),u(!1)}))}),[]);var j={currentUser:r,changeUser:function(e){o(e)}};return Object(f.jsx)(p.Provider,{value:j,children:!l&&t})}var x=n(39),v=n(16),m=n(134),y=n(50),k=function(e){console.log(e)};function w(){var e=O().changeUser,t=Object(v.g)();function n(){return(n=Object(l.a)(s.a.mark((function n(a){var c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e(a.profileObj);case 2:if(c=a.profileObj.email,-1!==c.indexOf("@college.harvard.edu")){n.next=11;break}return alert("Please sign in using your Harvard College email address!"),n.next=8,e(null);case 8:c=null,n.next=12;break;case 11:t.push("/");case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(f.jsx)(m.a,{style:{backgroundColor:"#A51C30"},children:Object(f.jsxs)(m.a.Body,{children:[Object(f.jsx)("h2",{className:"text-center mb-4",style:{color:"white"},children:"Nametag"}),Object(f.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(f.jsx)(y.GoogleLogin,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Log in with Google",onSuccess:function(e){return n.apply(this,arguments)},onFailure:k,cookiePolicy:"single_host_origin",isSignedIn:!0,uxMode:"popup"})})]})})}var S=n(31),C=n(43),N=n(133),I=n(52),A=n.n(I),L=n(130),U=n(131),P=n(71),R=n.n(P),z=n(69),T=n.n(z),W=n(55),F=n.n(W),G=n(72),M=n.n(G),E=n(68),H=n.n(E),D=n(70),B=n.n(D),V=n(34),_=n(128),J=Object(_.a)((function(e){return{button:{margin:e.spacing(1)}}}));var Q=function(){var e="user",t={facingMode:e},n=c.a.useState(e),r=Object(d.a)(n,2),o=r[0],i=r[1],u=c.a.useCallback((function(){i((function(t){return t===e?"environment":e}))}),[]),j=J(),b=Object(v.g)(),h=O().currentUser,p=Object(a.useRef)(null),g=Object(a.useRef)(),x=Object(a.useRef)(),m=Object(a.useRef)(),y=Object(a.useRef)(),k=Object(a.useState)(!1),w=Object(d.a)(k,2),I=w[0],P=w[1],z=Object(a.useState)("Hold the phone so that your face takes up the majority of the screen, but no parts of your head is cut off. Make sure you have good lighting and that you are not holding the phone at an angle. When you are ready, click the button above."),W=Object(d.a)(z,2),G=W[0],E=W[1],D=Object(a.useState)("Run facial recognition"),_=Object(d.a)(D,2),Q=_[0],q=_[1],Y=Object(a.useState)(!1),K=Object(d.a)(Y,2),Z=K[0],$=K[1],X=Object(a.useState)(!0),ee=Object(d.a)(X,2),te=ee[0],ne=ee[1],ae=Object(a.useState)(null),ce=Object(d.a)(ae,2),re=ce[0],oe=ce[1],ie=Object(a.useState)(null),se=Object(d.a)(ie,2),le=se[0],ue=se[1],de=Object(a.useState)(null),je=Object(d.a)(de,2),be=je[0],he=je[1],fe=Object(a.useState)(null),pe=Object(d.a)(fe,2),Oe=pe[0],ge=pe[1],xe=Object(a.useState)(null),ve=Object(d.a)(xe,2),me=ve[0],ye=ve[1];function ke(){b.push("/")}var we=function(){""===g.current.value||null==re?alert("Please scan your face and fill in your name."):(C.a.database().ref("Users/"+h.googleId).set({descriptor:re,name:g.current.value,phone:x.current.value,insta:m.current.value,snap:y.current.value},(function(e){console.log(e)})),ke(),alert("Successfully saved data!"))},Se=function(){P(!1),ne(!0)},Ce=function(){var e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return oe(null),e.next=3,Ne();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ne=function(){var e=Object(l.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof p.current||null===p.current||4!==p.current.video.readyState){e.next=7;break}return t=p.current.video,E("Analyzing face..."),e.next=5,V.a(t).withFaceLandmarks().withFaceDescriptor();case 5:null!=(n=e.sent)?(oe(n.descriptor),q("Run facial recognition"),$(!0),ne(!1),E("")):E("No face detected, please try again.");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){C.a.database().ref("Users/"+h.googleId).once("value",(function(e){e.exists()&&(oe(e.val().descriptor),ue(e.val().name),he(e.val().phone),ge(e.val().insta),ye(e.val().snap))}))}),[]),Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)("header",{className:"App-header",children:[Object(f.jsx)(L.a,{"aria-label":"home",onClick:function(){ke()},children:Object(f.jsx)(H.a,{})}),te?null:Object(f.jsx)(L.a,{"aria-label":"clear",onClick:function(){Se()},children:Object(f.jsx)(T.a,{})}),I?Object(f.jsxs)("div",{children:[Object(f.jsx)(A.a,{ref:p,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(S.a)(Object(S.a)({},t),{},{facingMode:o}),mirrored:o===e}),Z?Object(f.jsx)("div",{children:Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:j.button,onClick:function(){return Se()},children:"Finish"})}):Object(f.jsxs)("div",{children:[Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:j.button,onClick:function(){return ne(!0),q("Running facial recognition..."),void Ce()},children:Q}),te?null:Object(f.jsx)(L.a,{onClick:u,children:Object(f.jsx)(F.a,{})})]}),Object(f.jsx)("p",{children:G})]}):Object(f.jsxs)("div",{children:[Object(f.jsx)("p",{children:"The following inputs will be public to all Harvard College students when they scan your face. Please leave any field for which you do not want to be publicly available blank."}),Object(f.jsxs)(N.a,{children:[Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:j.button,startIcon:Object(f.jsx)(B.a,{}),onClick:function(){return ue(g.current.value),he(x.current.value),ge(m.current.value),ye(y.current.value),$(!1),ne(!1),void P(!0)},children:"Open Camera to scan face"}),re?Object(f.jsx)(R.a,{}):Object(f.jsx)(M.a,{}),Object(f.jsxs)("div",{children:[Object(f.jsxs)(N.a.Group,{id:"name",children:[Object(f.jsx)(N.a.Label,{children:"Name"}),Object(f.jsx)(N.a.Control,{ref:g,defaultValue:le,placeholder:"John Harvard",required:!0})]}),Object(f.jsxs)(N.a.Group,{id:"phone",children:[Object(f.jsx)(N.a.Label,{children:"Phone number"}),Object(f.jsx)(N.a.Control,{placeholder:"555-555-5555",defaultValue:be,ref:x})]}),Object(f.jsxs)(N.a.Group,{id:"insta",children:[Object(f.jsx)(N.a.Label,{children:"Instagram"}),Object(f.jsx)(N.a.Control,{placeholder:"username",defaultValue:Oe,ref:m})]}),Object(f.jsxs)(N.a.Group,{id:"snap",children:[Object(f.jsx)(N.a.Label,{children:"Snapchat"}),Object(f.jsx)(N.a.Control,{placeholder:"username",defaultValue:me,ref:y})]})]}),Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:j.button,onClick:function(){we()},children:"Save Profile"})]})]})]})})},q=n(75),Y=["component"];function K(e){var t=e.component,n=Object(q.a)(e,Y),a=O().currentUser;return Object(f.jsx)(v.b,Object(S.a)(Object(S.a)({},n),{},{render:function(e){return a?Object(f.jsx)(t,Object(S.a)({},e)):Object(f.jsx)(v.a,{to:"/login"})}}))}var Z=n(73),$=n.n(Z),X=n(74),ee=n.n(X),te=Object(_.a)((function(e){return{button:{margin:e.spacing(1)}}}));var ne=function(){var e,t="user",n="environment",r={facingMode:t},o=c.a.useState(n),i=Object(d.a)(o,2),u=i[0],j=i[1],b=c.a.useCallback((function(){j((function(e){return e===t?n:t}))}),[]),h=Object(v.g)(),p=O(),g=p.changeUser,x=p.currentUser,m=te(),k=Object(a.useState)("Hold the phone so that the person's face takes up the majority of the screen, but no part of their head is cut off. Make sure you have good lighting and that you are not holding the camera at an angle. When you are ready, click the button above."),w=Object(d.a)(k,2),N=w[0],I=w[1],P=Object(a.useState)(!1),R=Object(d.a)(P,2),z=R[0],T=R[1],W=Object(a.useState)("Run facial recognition"),G=Object(d.a)(W,2),M=G[0],E=G[1],H=Object(a.useState)(""),D=Object(d.a)(H,2),B=D[0],_=D[1],J=Object(a.useState)(""),Q=Object(d.a)(J,2),q=Q[0],Y=Q[1],K=Object(a.useState)(""),Z=Object(d.a)(K,2),X=Z[0],ne=Z[1],ae=Object(a.useState)(""),ce=Object(d.a)(ae,2),re=ce[0],oe=ce[1],ie=Object(a.useState)(!1),se=Object(d.a)(ie,2),le=se[0],ue=se[1],de="sms:"+q,je="instagram://user?username="+re,be="snapchat://add/"+X,he=Object(a.useRef)(null);function fe(){return(fe=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(null);case 2:h.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pe=function(){var t=Object(l.a)(s.a.mark((function t(){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,t.next=3,Oe();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Oe=function(){var t=Object(l.a)(s.a.mark((function t(){var n,a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof he.current||null===he.current||4!==he.current.video.readyState){t.next=7;break}return n=he.current.video,I("Analyzing face..."),t.next=5,V.a(n).withFaceLandmarks().withFaceDescriptor();case 5:null!=(a=t.sent)?(e=a.descriptor,E("Run facial recognition"),I("The scanned face does not match any face in our database."),ge(),ue(!1)):I("No face detected, please try again.");case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),ge=function(){var t=1;C.a.database().ref("Users").on("child_added",(function(n){var a=n.val(),c=1;null!=a.descriptor&&(c=V.b(a.descriptor,e)),c<t&&c<.5&&(t=c,T(!0),_(a.name),Y(a.phone),ne(a.snap),oe(a.insta),I(""))}))};return Object(a.useEffect)((function(){C.a.database().ref("Users/"+x.googleId).once("value",(function(e){e.exists()||(h.push("/profile"),alert("Please fill out your profile first!"))}))}),[]),Object(f.jsx)("div",{className:"App",style:{textAlign:"center"},children:Object(f.jsxs)("header",{className:"App-header",children:[Object(f.jsx)(y.GoogleLogout,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){return fe.apply(this,arguments)}}),Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:m.button,startIcon:Object(f.jsx)($.a,{}),onClick:function(){h.push("/profile")},children:"Profile"}),Object(f.jsx)(U.a,{variant:"contained",color:"secondary",size:"small",startIcon:Object(f.jsx)(ee.a,{}),onClick:function(){return window.open("https://venmo.com/code?user_id=3203314787287040028&created=1631377064","_blank")},children:"Donate"}),Object(f.jsxs)("div",{children:[Object(f.jsx)(A.a,{ref:he,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(S.a)(Object(S.a)({},r),{},{facingMode:u}),mirrored:u===t}),Object(f.jsx)(U.a,{variant:"contained",color:"primary",size:"small",className:m.button,onClick:function(){return E("Running facial recognition..."),ue(!0),_(""),Y(""),ne(""),oe(""),T(!1),void pe()},children:M}),le?null:Object(f.jsx)(L.a,{onClick:b,children:Object(f.jsx)(F.a,{})})]}),Object(f.jsx)("hr",{}),Object(f.jsx)("p",{children:N}),z?Object(f.jsxs)("div",{style:{border:"2px solid black",backgroundColor:"lightgray",paddingTop:"10px"},children:[Object(f.jsx)("p",{children:"Name: "+B}),Object(f.jsxs)("p",{children:["Phone number: ",Object(f.jsx)("a",{href:de,children:q})]}),Object(f.jsxs)("p",{children:["Snapchat:  ",Object(f.jsx)("a",{href:be,children:X})]}),Object(f.jsxs)("p",{children:["Instagram: ",Object(f.jsx)("a",{href:je,children:re})]})]}):null,Object(f.jsx)("br",{})]})})};var ae=function(){function e(){return(e=Object(l.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V.e("/nametag/models");case 2:return e.next=4,V.c("/nametag/models");case 4:return e.next=6,V.d("/nametag/models");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(a.useEffect)((function(){!function(){e.apply(this,arguments)}()})),Object(f.jsx)(u.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(f.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:Object(f.jsx)(x.a,{basename:"/nametag",children:Object(f.jsx)(g,{children:Object(f.jsxs)(v.d,{children:[Object(f.jsx)(K,{exact:!0,path:"/",component:ne}),Object(f.jsx)(K,{path:"/profile",component:Q}),Object(f.jsx)(v.b,{path:"/login",component:w})]})})})})})},ce=(n(113),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function re(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,136)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(f.jsx)(c.a.StrictMode,{children:Object(f.jsx)(ae,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/nametag",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/nametag","/service-worker.js");ce?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):re(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):re(t,e)}))}}(),oe()}},[[115,1,2]]]);
//# sourceMappingURL=main.a0e62258.chunk.js.map