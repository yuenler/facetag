(this.webpackJsonpnametag=this.webpackJsonpnametag||[]).push([[0],{103:function(e,t){},104:function(e,t){},105:function(e,t){},111:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),r=n(40),s=n.n(r),i=n(128),o=n(14),l=n(66),u=(n(87),l.a.initializeApp({apiKey:"AIzaSyCUqHmiQD8PkE0UDMsuHjAhrZ9QQNrydeg",authDomain:"nametag-de54e.firebaseapp.com",projectId:"nametag-de54e",storageBucket:"nametag-de54e.appspot.com",messagingSenderId:"686023333837",appId:"1:686023333837:web:80907e123a1eb4f45e5684",measurementId:"G-YYT9G3V3TS"})),j=u.auth(),d=n(6),b=c.a.createContext();function h(){return Object(a.useContext)(b)}function f(e){var t=e.children,n=Object(a.useState)(),c=Object(o.a)(n,2),r=c[0],s=c[1],i=Object(a.useState)(!0),l=Object(o.a)(i,2),u=l[0],h=l[1];Object(a.useEffect)((function(){return j.onAuthStateChanged((function(e){s(e),h(!1)}))}),[]);var f={currentUser:r,changeUser:function(e){s(e)}};return Object(d.jsx)(b.Provider,{value:f,children:!u&&t})}var p=n(39),O=n(16),x=n(22),g=n.n(x),m=n(34),v=n(130),y=n(48),k=function(e){console.log(e)};function S(){var e=h().changeUser,t=Object(O.g)();function n(){return(n=Object(m.a)(g.a.mark((function n(a){var c;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e(a.profileObj);case 2:if(c=a.profileObj.email,-1!==c.indexOf("@college.harvard.edu")){n.next=11;break}return alert("Please sign in using your Harvard College email address!"),n.next=8,e(null);case 8:c=null,n.next=12;break;case 11:t.push("/");case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(d.jsx)(v.a,{style:{backgroundColor:"#A51C30"},children:Object(d.jsxs)(v.a.Body,{children:[Object(d.jsx)("h2",{className:"text-center mb-4",style:{color:"white"},children:"Nametag"}),Object(d.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(d.jsx)(y.GoogleLogin,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Log in with Google",onSuccess:function(e){return n.apply(this,arguments)},onFailure:k,cookiePolicy:"single_host_origin",isSignedIn:!0,uxMode:"redirect",redirectUri:window.location.href})})]})})}var C=n(31),w=n(55),I=n(129),N=n(50),A=n.n(N),R=n(126),L=n(127),P=n(71),U=n.n(P),z=n(69),G=n.n(z),M=n(53),H=n.n(M),E=n(72),F=n.n(E),T=n(68),D=n.n(T),V=n(70),B=n.n(V),J=n(27),Q=n(124),W=Object(Q.a)((function(e){return{button:{margin:e.spacing(1),backgroundColor:"#A51C30"}}}));var _=function(){var e="user",t={facingMode:e},n=c.a.useState(e),r=Object(o.a)(n,2),s=r[0],i=r[1],l=c.a.useCallback((function(){i((function(t){return t===e?"environment":e}))}),[]),u=W(),j=Object(O.g)(),b=h().currentUser,f=Object(a.useRef)(null),p=Object(a.useRef)(),x=Object(a.useRef)(),v=Object(a.useRef)(),y=Object(a.useRef)(),k=[],S=Object(a.useState)(!1),N=Object(o.a)(S,2),P=N[0],z=N[1],M=Object(a.useState)("Run facial recognition"),E=Object(o.a)(M,2),T=E[0],V=E[1],Q=Object(a.useState)(null),_=Object(o.a)(Q,2),q=_[0],Y=_[1],K=Object(a.useState)(!1),Z=Object(o.a)(K,2),X=Z[0],$=Z[1],ee=Object(a.useState)(!0),te=Object(o.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(null),re=Object(o.a)(ce,2),se=re[0],ie=(re[1],Object(a.useState)(null)),oe=Object(o.a)(ie,2),le=oe[0],ue=(oe[1],Object(a.useState)(null)),je=Object(o.a)(ue,2),de=je[0],be=(je[1],Object(a.useState)(null)),he=Object(o.a)(be,2),fe=he[0];function pe(){j.push("/")}he[1];var Oe=function(){""===p.current.value||null==q?alert("Please scan your face and fill in your name."):(w.a.database().ref("Users/"+b.googleId).set({descriptor:q,name:p.current.value,phone:x.current.value,insta:v.current.value,snap:y.current.value},(function(e){console.log(e)})),pe(),alert("Successfully saved data!"))},xe=function(){z(!1),ae(!0)},ge=function(){var e=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.e("/nametag/models");case 2:return e.next=4,J.c("/nametag/models");case 4:return e.next=6,J.d("/nametag/models");case 6:if(!(k.length<=5)){e.next=11;break}return e.next=9,ve();case 9:e.next=6;break;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),me=function(e){for(var t=[],n=0;n<128;n++){for(var a,c=0,r=0;r<e.length;r++)c+=e[r][n];a=c/e.length,t.push(a)}return t},ve=function(){var e=Object(m.a)(g.a.mark((function e(){var t,n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof f.current||null===f.current||4!==f.current.video.readyState){e.next=6;break}return t=f.current.video,e.next=4,J.a(t).withFaceLandmarks().withFaceDescriptor();case 4:null!=(n=e.sent)&&(k.push(n.descriptor),k.length>=5&&(clearInterval(undefined),V("Run facial recognition"),5===k.length&&(a=me(k),Y(a),$(!0),ae(!1))));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){})),Object(d.jsx)("div",{className:"App",children:Object(d.jsxs)("header",{className:"App-header",children:[Object(d.jsx)(R.a,{"aria-label":"home",onClick:function(){pe()},children:Object(d.jsx)(D.a,{})}),ne?null:Object(d.jsx)(R.a,{"aria-label":"clear",onClick:function(){xe()},children:Object(d.jsx)(G.a,{})}),P?Object(d.jsxs)("div",{children:[Object(d.jsx)(A.a,{ref:f,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(C.a)(Object(C.a)({},t),{},{facingMode:s})}),X?Object(d.jsx)("div",{children:Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){return xe()},children:"Finish"})}):Object(d.jsxs)("div",{children:[Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){return ae(!0),V("Running facial recognition..."),void ge()},children:T}),ne?null:Object(d.jsx)(R.a,{onClick:l,children:Object(d.jsx)(H.a,{})})]}),Object(d.jsx)("p",{children:"Hold the phone so that your face takes up the majority of the screen, but no parts of your head is cut off. Make sure you have good lighting and that you are not holding the phone at an angle. When you are ready, click the button above. "})]}):Object(d.jsxs)("div",{children:[Object(d.jsx)("p",{children:"The following inputs will be public to all Harvard College students when they scan your face. Please leave any field for which you do not want to be publicly available blank."}),Object(d.jsxs)(I.a,{children:[Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,startIcon:Object(d.jsx)(B.a,{}),onClick:function(){return $(!1),ae(!1),void z(!0)},children:"Open Camera to scan face"}),q?Object(d.jsx)(U.a,{}):Object(d.jsx)(F.a,{}),Object(d.jsxs)("div",{children:[Object(d.jsxs)(I.a.Group,{id:"name",children:[Object(d.jsx)(I.a.Label,{children:"Name"}),Object(d.jsx)(I.a.Control,{ref:p,defaultValue:se,placeholder:"John Harvard",required:!0})]}),Object(d.jsxs)(I.a.Group,{id:"phone",children:[Object(d.jsx)(I.a.Label,{children:"Phone number"}),Object(d.jsx)(I.a.Control,{placeholder:"555-555-5555",defaultValue:le,ref:x})]}),Object(d.jsxs)(I.a.Group,{id:"insta",children:[Object(d.jsx)(I.a.Label,{children:"Instagram"}),Object(d.jsx)(I.a.Control,{placeholder:"username",defaultValue:de,ref:v})]}),Object(d.jsxs)(I.a.Group,{id:"snap",children:[Object(d.jsx)(I.a.Label,{children:"Snapchat"}),Object(d.jsx)(I.a.Control,{placeholder:"username",defaultValue:fe,ref:y})]})]}),Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){Oe()},children:"Save Profile"})]})]})]})})};n(74);var q=n(73),Y=n.n(q),K=Object(Q.a)((function(e){return{button:{margin:e.spacing(1),backgroundColor:"#A51C30"}}}));var Z=function(){var e,t="user",n="environment",r={facingMode:t},s=c.a.useState(n),i=Object(o.a)(s,2),l=i[0],u=i[1],j=c.a.useCallback((function(){u((function(e){return e===t?n:t}))}),[]),b=Object(O.g)(),f=h(),p=f.changeUser,x=(f.currentUser,K()),v=Object(a.useState)("Hold the phone so that the person's face takes up the majority of the screen, but no part of their head is off screen. Make sure you have good lighting and that you are not holding the camera at an angle. When you are ready, click the button above."),k=Object(o.a)(v,2),S=k[0],I=k[1],N=Object(a.useState)(!1),P=Object(o.a)(N,2),U=P[0],z=P[1],G=Object(a.useState)("Run facial recognition"),M=Object(o.a)(G,2),E=M[0],F=M[1],T=Object(a.useState)(""),D=Object(o.a)(T,2),V=D[0],B=D[1],Q=Object(a.useState)(""),W=Object(o.a)(Q,2),_=W[0],q=W[1],Z=Object(a.useState)(""),X=Object(o.a)(Z,2),$=X[0],ee=X[1],te=Object(a.useState)(""),ne=Object(o.a)(te,2),ae=ne[0],ce=ne[1],re=Object(a.useState)(!1),se=Object(o.a)(re,2),ie=se[0],oe=se[1],le="sms:"+_,ue=Object(a.useRef)(null),je=[];function de(){return(de=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(null);case 2:b.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var be=function(){var e=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.e("/nametag/models");case 2:return e.next=4,J.c("/nametag/models");case 4:return e.next=6,J.d("/nametag/models");case 6:if(!(je.length<=1)){e.next=11;break}return e.next=9,fe();case 9:e.next=6;break;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),he=function(e){for(var t=[],n=0;n<128;n++){for(var a,c=0,r=0;r<e.length;r++)c+=e[r][n];a=c/e.length,t.push(a)}return t},fe=function(){var t=Object(m.a)(g.a.mark((function t(){var n,a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof ue.current||null===ue.current||4!==ue.current.video.readyState){t.next=6;break}return n=ue.current.video,t.next=4,J.a(n).withFaceLandmarks().withFaceDescriptor();case 4:null!=(a=t.sent)&&(je.push(a.descriptor),je.length>=1&&(clearInterval(undefined),F("Run facial recognition"),1===je.length&&(I("Processing results...\nIf no results appear within 10 seconds, this means that the scanned face does not match any face in our database."),e=he(je),pe(),oe(!1))));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),pe=function(){var t=1;w.a.database().ref("Users").on("child_added",(function(n){var a=n.val(),c=1;null!=a.descriptor&&(c=J.b(a.descriptor,e)),c<t&&c<.5&&(t=c,z(!0),B(a.name),q(a.phone),ee(a.snap),ce(a.insta),I(""))}))};return Object(a.useEffect)((function(){})),Object(d.jsx)("div",{className:"App",style:{textAlign:"center"},children:Object(d.jsxs)("header",{className:"App-header",children:[Object(d.jsx)(y.GoogleLogout,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){return de.apply(this,arguments)}}),Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:x.button,startIcon:Object(d.jsx)(Y.a,{}),onClick:function(){b.push("/profile")},children:"Edit Profile"}),Object(d.jsxs)("div",{children:[Object(d.jsx)(A.a,{ref:ue,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(C.a)(Object(C.a)({},r),{},{facingMode:l})}),Object(d.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:x.button,onClick:function(){return F("Running facial recognition..."),oe(!0),B(""),q(""),ee(""),ce(""),z(!1),void be()},children:E}),ie?null:Object(d.jsx)(R.a,{onClick:j,children:Object(d.jsx)(H.a,{})})]}),Object(d.jsx)("hr",{}),Object(d.jsx)("p",{children:S}),U?Object(d.jsxs)("div",{style:{border:"2px solid black",backgroundColor:"lightgray",paddingTop:"10px"},children:[Object(d.jsx)("p",{children:"Name: "+V}),Object(d.jsxs)("p",{children:["Phone number: ",Object(d.jsx)("a",{href:le,children:_})]}),Object(d.jsx)("p",{children:"Snapchat: "+$}),Object(d.jsx)("p",{children:"Instagram: "+ae})]}):null,Object(d.jsx)("br",{})]})})};var X=function(){return Object(d.jsx)(i.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(d.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:Object(d.jsx)(p.a,{basename:"/nametag",children:Object(d.jsx)(f,{children:Object(d.jsxs)(O.d,{children:[Object(d.jsx)(O.b,{exact:!0,path:"/",component:Z}),Object(d.jsx)(O.b,{path:"/profile",component:_}),Object(d.jsx)(O.b,{path:"/login",component:S})]})})})})})};n(109);s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(X,{})}),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.032cdb04.chunk.js.map