(this.webpackJsonpnametag=this.webpackJsonpnametag||[]).push([[0],{103:function(e,t){},104:function(e,t){},105:function(e,t){},111:function(e,t,n){"use strict";n.r(t);var a=n(3),c=n.n(a),r=n(40),s=n.n(r),o=n(128),i=n(14),l=n(66),u=(n(87),l.a.initializeApp({apiKey:"AIzaSyCUqHmiQD8PkE0UDMsuHjAhrZ9QQNrydeg",authDomain:"nametag-de54e.firebaseapp.com",projectId:"nametag-de54e",storageBucket:"nametag-de54e.appspot.com",messagingSenderId:"686023333837",appId:"1:686023333837:web:80907e123a1eb4f45e5684",measurementId:"G-YYT9G3V3TS"})),j=u.auth(),b=n(6),d=c.a.createContext();function h(){return Object(a.useContext)(d)}function f(e){var t=e.children,n=Object(a.useState)(),c=Object(i.a)(n,2),r=c[0],s=c[1],o=Object(a.useState)(!0),l=Object(i.a)(o,2),u=l[0],h=l[1];Object(a.useEffect)((function(){return j.onAuthStateChanged((function(e){s(e),h(!1)}))}),[]);var f={currentUser:r,changeUser:function(e){s(e)}};return Object(b.jsx)(d.Provider,{value:f,children:!u&&t})}var p=n(39),O=n(16),x=n(22),g=n.n(x),m=n(34),v=n(130),y=n(49),k=function(e){console.log(e)};function S(){var e=h().changeUser,t=Object(O.g)();function n(){return(n=Object(m.a)(g.a.mark((function n(a){var c;return g.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e(a.profileObj);case 2:if(c=a.profileObj.email,-1!==c.indexOf("@college.harvard.edu")){n.next=11;break}return alert("Please sign in using your Harvard College email address!"),n.next=8,e(null);case 8:c=null,n.next=12;break;case 11:t.push("/");case 12:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return Object(b.jsx)(v.a,{style:{backgroundColor:"#A51C30"},children:Object(b.jsxs)(v.a.Body,{children:[Object(b.jsx)("h2",{className:"text-center mb-4",style:{color:"white"},children:"Nametag"}),Object(b.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(b.jsx)(y.GoogleLogin,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Log in with Google",onSuccess:function(e){return n.apply(this,arguments)},onFailure:k,cookiePolicy:"single_host_origin",isSignedIn:!0})})]})})}var C=n(31),w=n(43),I=n(129),N=n(51),A=n.n(N),R=n(126),L=n(127),U=n(71),P=n.n(U),z=n(69),G=n.n(z),H=n(54),M=n.n(H),E=n(72),F=n.n(E),T=n(68),D=n.n(T),V=n(70),B=n.n(V),J=n(27),Q=n(124),W=Object(Q.a)((function(e){return{button:{margin:e.spacing(1),backgroundColor:"#A51C30"}}}));var _=function(){var e="user",t={facingMode:e},n=c.a.useState(e),r=Object(i.a)(n,2),s=r[0],o=r[1],l=c.a.useCallback((function(){o((function(t){return t===e?"environment":e}))}),[]),u=W(),j=Object(O.g)(),d=h().currentUser,f=Object(a.useRef)(null),p=Object(a.useRef)(),x=Object(a.useRef)(),v=Object(a.useRef)(),y=Object(a.useRef)(),k=[],S=Object(a.useState)(!1),N=Object(i.a)(S,2),U=N[0],z=N[1],H=Object(a.useState)("Run facial recognition"),E=Object(i.a)(H,2),T=E[0],V=E[1],Q=Object(a.useState)(null),_=Object(i.a)(Q,2),q=_[0],Y=_[1],K=Object(a.useState)(!1),Z=Object(i.a)(K,2),X=Z[0],$=Z[1],ee=Object(a.useState)(!0),te=Object(i.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(null),re=Object(i.a)(ce,2),se=re[0],oe=re[1],ie=Object(a.useState)(null),le=Object(i.a)(ie,2),ue=le[0],je=le[1],be=Object(a.useState)(null),de=Object(i.a)(be,2),he=de[0],fe=de[1],pe=Object(a.useState)(null),Oe=Object(i.a)(pe,2),xe=Oe[0],ge=Oe[1];function me(){j.push("/")}var ve=function(){""===p.current.value||null==q?alert("Please scan your face and fill in your name."):(w.a.database().ref("Users/"+d.googleId).set({descriptor:q,name:p.current.value,phone:x.current.value,insta:v.current.value,snap:y.current.value},(function(e){console.log(e)})),me(),alert("Successfully saved data!"))},ye=function(){z(!1),ae(!0)},ke=function(){var e=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.e("/models");case 2:return e.next=4,J.c("/models");case 4:return e.next=6,J.d("/models");case 6:if(!(k.length<=5)){e.next=11;break}return e.next=9,Ce();case 9:e.next=6;break;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Se=function(e){for(var t=[],n=0;n<128;n++){for(var a,c=0,r=0;r<e.length;r++)c+=e[r][n];a=c/e.length,t.push(a)}return t},Ce=function(){var e=Object(m.a)(g.a.mark((function e(){var t,n,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"===typeof f.current||null===f.current||4!==f.current.video.readyState){e.next=6;break}return t=f.current.video,e.next=4,J.a(t).withFaceLandmarks().withFaceDescriptor();case 4:null!=(n=e.sent)&&(k.push(n.descriptor),k.length>=5&&(clearInterval(undefined),V("Run facial recognition"),5===k.length&&(a=Se(k),Y(a),$(!0),ae(!1))));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){w.a.database().ref("Users/"+d.googleId).once("value",(function(e){e.exists()&&(Y(e.val().descriptor),oe(e.val().name),je(e.val().phone),fe(e.val().insta),ge(e.val().snap))}))})),Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)("header",{className:"App-header",children:[Object(b.jsx)(R.a,{"aria-label":"home",onClick:function(){me()},children:Object(b.jsx)(D.a,{})}),ne?null:Object(b.jsx)(R.a,{"aria-label":"clear",onClick:function(){ye()},children:Object(b.jsx)(G.a,{})}),U?Object(b.jsxs)("div",{children:[Object(b.jsx)(A.a,{ref:f,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(C.a)(Object(C.a)({},t),{},{facingMode:s})}),X?Object(b.jsx)("div",{children:Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){return ye()},children:"Finish"})}):Object(b.jsxs)("div",{children:[Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){return ae(!0),V("Running facial recognition..."),void ke()},children:T}),ne?null:Object(b.jsx)(R.a,{onClick:l,children:Object(b.jsx)(M.a,{})})]}),Object(b.jsx)("p",{children:"Hold the phone so that your face takes up the majority of the screen, but no parts of your head is cut off. Make sure you have good lighting and that you are not holding the phone at an angle. When you are ready, click the button above. "})]}):Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"The following inputs will be public to all Harvard College students when they scan your face. Please leave any field for which you do not want to be publicly available blank."}),Object(b.jsxs)(I.a,{children:[Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,startIcon:Object(b.jsx)(B.a,{}),onClick:function(){return $(!1),ae(!1),void z(!0)},children:"Open Camera to scan face"}),q?Object(b.jsx)(P.a,{}):Object(b.jsx)(F.a,{}),Object(b.jsxs)("div",{children:[Object(b.jsxs)(I.a.Group,{id:"name",children:[Object(b.jsx)(I.a.Label,{children:"Name"}),Object(b.jsx)(I.a.Control,{ref:p,defaultValue:se,placeholder:"John Harvard",required:!0})]}),Object(b.jsxs)(I.a.Group,{id:"phone",children:[Object(b.jsx)(I.a.Label,{children:"Phone number"}),Object(b.jsx)(I.a.Control,{placeholder:"555-555-5555",defaultValue:ue,ref:x})]}),Object(b.jsxs)(I.a.Group,{id:"insta",children:[Object(b.jsx)(I.a.Label,{children:"Instagram"}),Object(b.jsx)(I.a.Control,{placeholder:"username",defaultValue:he,ref:v})]}),Object(b.jsxs)(I.a.Group,{id:"snap",children:[Object(b.jsx)(I.a.Label,{children:"Snapchat"}),Object(b.jsx)(I.a.Control,{placeholder:"username",defaultValue:xe,ref:y})]})]}),Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:u.button,onClick:function(){ve()},children:"Save Profile"})]})]})]})})},q=n(74);function Y(e){var t=e.component,n=Object(q.a)(e,["component"]),a=h().currentUser;return Object(b.jsx)(O.b,Object(C.a)(Object(C.a)({},n),{},{render:function(e){return a?Object(b.jsx)(t,Object(C.a)({},e)):Object(b.jsx)(O.a,{to:"/login"})}}))}var K=n(73),Z=n.n(K),X=Object(Q.a)((function(e){return{button:{margin:e.spacing(1),backgroundColor:"#A51C30"}}}));var $=function(){var e,t="user",n="environment",r={facingMode:t},s=c.a.useState(n),o=Object(i.a)(s,2),l=o[0],u=o[1],j=c.a.useCallback((function(){u((function(e){return e===t?n:t}))}),[]),d=Object(O.g)(),f=h(),p=f.changeUser,x=f.currentUser,v=X(),k=Object(a.useState)("Hold the phone so that the person's face takes up the majority of the screen, but no part of their head is off screen. Make sure you have good lighting and that you are not holding the camera at an angle. When you are ready, click the button above."),S=Object(i.a)(k,2),I=S[0],N=S[1],U=Object(a.useState)(!1),P=Object(i.a)(U,2),z=P[0],G=P[1],H=Object(a.useState)("Run facial recognition"),E=Object(i.a)(H,2),F=E[0],T=E[1],D=Object(a.useState)(""),V=Object(i.a)(D,2),B=V[0],Q=V[1],W=Object(a.useState)(""),_=Object(i.a)(W,2),q=_[0],Y=_[1],K=Object(a.useState)(""),$=Object(i.a)(K,2),ee=$[0],te=$[1],ne=Object(a.useState)(""),ae=Object(i.a)(ne,2),ce=ae[0],re=ae[1],se=Object(a.useState)(!1),oe=Object(i.a)(se,2),ie=oe[0],le=oe[1],ue="sms:"+q,je=Object(a.useRef)(null),be=[];function de(){return(de=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(null);case 2:d.push("/login");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var he=function(){var e=Object(m.a)(g.a.mark((function e(){return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.e("/models");case 2:return e.next=4,J.c("/models");case 4:return e.next=6,J.d("/models");case 6:if(!(be.length<=1)){e.next=11;break}return e.next=9,pe();case 9:e.next=6;break;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),fe=function(e){for(var t=[],n=0;n<128;n++){for(var a,c=0,r=0;r<e.length;r++)c+=e[r][n];a=c/e.length,t.push(a)}return t},pe=function(){var t=Object(m.a)(g.a.mark((function t(){var n,a;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"===typeof je.current||null===je.current||4!==je.current.video.readyState){t.next=6;break}return n=je.current.video,t.next=4,J.a(n).withFaceLandmarks().withFaceDescriptor();case 4:null!=(a=t.sent)&&(be.push(a.descriptor),console.log("hi"),be.length>=1&&(clearInterval(undefined),T("Run facial recognition"),1===be.length&&(N("Processing results...\nIf no results appear within 10 seconds, this means that the scanned face does not match any face in our database."),e=fe(be),Oe(),le(!1))));case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Oe=function(){var t=1;w.a.database().ref("Users").on("child_added",(function(n){var a=n.val(),c=J.b(a.descriptor,e);console.log(c),c<t&&c<.5&&(t=c,G(!0),Q(a.name),Y(a.phone),te(a.snap),re(a.insta),N(""))}))};return Object(a.useEffect)((function(){w.a.database().ref("Users/"+x.googleId).once("value",(function(e){e.exists()||(d.push("/profile"),alert("Please fill out your profile first!"))}))})),Object(b.jsx)("div",{className:"App",style:{textAlign:"center"},children:Object(b.jsxs)("header",{className:"App-header",children:[Object(b.jsx)(y.GoogleLogout,{clientId:"686023333837-p65ka8pm804ual7o284tholp22pll81s.apps.googleusercontent.com",buttonText:"Logout",onLogoutSuccess:function(){return de.apply(this,arguments)}}),Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:v.button,startIcon:Object(b.jsx)(Z.a,{}),onClick:function(){d.push("/profile")},children:"Edit Profile"}),Object(b.jsxs)("div",{children:[Object(b.jsx)(A.a,{ref:je,style:{marginLeft:"auto",marginRight:"auto",left:0,right:0,textAlign:"center",zindex:9,width:300,height:300},videoConstraints:Object(C.a)(Object(C.a)({},r),{},{facingMode:l})}),Object(b.jsx)(L.a,{variant:"contained",color:"primary",size:"small",className:v.button,onClick:function(){return T("Running facial recognition..."),le(!0),Q(""),Y(""),te(""),re(""),G(!1),void he()},children:F}),ie?null:Object(b.jsx)(R.a,{onClick:j,children:Object(b.jsx)(M.a,{})})]}),Object(b.jsx)("hr",{}),Object(b.jsx)("p",{children:I}),z?Object(b.jsxs)("div",{style:{border:"2px solid black",backgroundColor:"lightgray",paddingTop:"10px"},children:[Object(b.jsx)("p",{children:"Name: "+B}),Object(b.jsxs)("p",{children:["Phone number: ",Object(b.jsx)("a",{href:ue,children:q})]}),Object(b.jsx)("p",{children:"Snapchat: "+ee}),Object(b.jsx)("p",{children:"Instagram: "+ce})]}):null,Object(b.jsx)("br",{})]})})};var ee=function(){return Object(b.jsx)(o.a,{className:"d-flex align-items-center justify-content-center",style:{minHeight:"100vh"},children:Object(b.jsx)("div",{className:"w-100",style:{maxWidth:"400px"},children:Object(b.jsx)(p.a,{basename:"/nametag/",children:Object(b.jsx)(f,{children:Object(b.jsxs)(O.d,{children:[Object(b.jsx)(Y,{exact:!0,path:"/",component:$}),Object(b.jsx)(Y,{path:"/profile",component:_}),Object(b.jsx)(O.b,{path:"/login",component:S})]})})})})})};n(109);s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(ee,{})}),document.getElementById("root"))}},[[111,1,2]]]);
//# sourceMappingURL=main.ca57a32e.chunk.js.map